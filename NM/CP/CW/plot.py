import matplotlib.pyplot as plt
import numpy as np

kv = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

mcm = [121, 1638, 6728, 12430, 23540, 52507, 88835, 180836, 261663, 384985]
qm = [24, 11, 11, 26, 189, 2102, 28528, 309291, 5716616, 56742101]

mc_err = [0.011091008268576397, 0.0018354110275611291, 0.0053467576385770599, 0.012806040648641215, 0.0082200235900984353, 0.0014556457723244876, 0.012274009505745198, 0.012713961811755325, 0.0031150520892424538, 0.01548236547137094]
q_err = [0.018518518518518545, 0.020833333333333037, 0.020000000000006679, 0.026666666666670835, 0.023148148148123937, 0.027777777777657775, 0.023809523809404709, 0.027210884353507936, 0.0234375, 0.026041666666742458]
mc_calls = [834, 21667, 89167, 230000, 470834, 838334, 1359167, 2060001, 2967500, 4108334]
q_calls =  [4, 30, 258, 1554, 19607, 137256, 2396744, 19173960, 435848049, 3922632450]


eps = 0.03
eps_line = [eps for i in range(len(kv))]

print(kv[:8])

plt.plot(kv[:8], mcm[:8], linestyle='--', marker='o', color = 'm', label='Метод Монте-карло', zorder=2)
plt.plot(kv[:8], qm[:8], linestyle='--', marker='o', color = 'blue', label='Метод квадратур', zorder=2)
plt.grid(linewidth=0.2)
plt.title("Зависимость времени вычислений от размерности\n задачи (для достижения точности eps=0.03)")
plt.xlabel("n")
plt.ylabel("t, мкс")
plt.legend()
plt.tight_layout()
plt.show()

plt.plot(kv[:8], mc_calls[:8], linestyle='--', marker='o', color = 'm', label='Метод Монте-карло', zorder=2)
plt.plot(kv[:8], q_calls[:8], linestyle='--', marker='o', color = 'blue', label='Метод квадратур', zorder=2)
plt.title("Зависимость кол-ва вызовов интегрируемой\n функции отразмерности задачи\n (для достижения точности eps=0.03)")
plt.xlabel("n")
plt.ylabel("k")
plt.legend()
plt.tight_layout()
plt.show()

plt.plot(kv[:8], mc_err[:8], linestyle='--', marker='o', color = 'm', label='Метод Монте-карло', zorder=2)
plt.plot(kv[:8], q_err[:8], linestyle='--', marker='o', color = 'blue', label='Метод квадратур', zorder=2)
plt.plot(kv[:8], eps_line[:8], linestyle='--', color = 'red', label='eps', zorder=2)

plt.title("Фактическая абсолютная погрешность\n вычислений (за одно вычисление)")
plt.xlabel("d")
plt.ylabel("n")
plt.legend()
plt.tight_layout()
plt.show()

eps = [1, 0.98999999999999999, 0.97999999999999998, 0.96999999999999997, 0.95999999999999996, 0.94999999999999996, 0.93999999999999995, 0.93000000000000005, 0.92000000000000004, 0.91000000000000003, 0.90000000000000002, 0.89000000000000001, 0.88, 0.87, 0.85999999999999999, 0.84999999999999998, 0.83999999999999997, 0.82999999999999996, 0.81999999999999995, 0.80999999999999994, 0.80000000000000004, 0.79000000000000004, 0.78000000000000003, 0.77000000000000002, 0.76000000000000001, 0.75, 0.73999999999999999, 0.72999999999999998, 0.71999999999999997, 0.70999999999999996, 0.69999999999999996, 0.68999999999999995, 0.67999999999999994, 0.67000000000000004, 0.66000000000000003, 0.65000000000000002, 0.64000000000000001, 0.63, 0.62, 0.60999999999999999, 0.59999999999999998, 0.58999999999999997, 0.57999999999999996, 0.56999999999999995, 0.55999999999999994, 0.55000000000000004, 0.54000000000000004, 0.53000000000000003, 0.52000000000000002, 0.51000000000000001, 0.5, 0.48999999999999999, 0.47999999999999998, 0.46999999999999997, 0.45999999999999996, 0.45000000000000001, 0.44, 0.42999999999999999, 0.41999999999999998, 0.40999999999999998, 0.39999999999999997, 0.39000000000000001, 0.38, 0.37, 0.35999999999999999, 0.34999999999999998, 0.33999999999999997, 0.32999999999999996, 0.32000000000000001, 0.31, 0.29999999999999999, 0.28999999999999998, 0.27999999999999997, 0.26999999999999996, 0.26000000000000001, 0.24999999999999997, 0.23999999999999999, 0.22999999999999998, 0.21999999999999997, 0.20999999999999999, 0.19999999999999998, 0.18999999999999997, 0.17999999999999999, 0.16999999999999998, 0.15999999999999998, 0.14999999999999999, 0.13999999999999999, 0.12999999999999998, 0.11999999999999998, 0.10999999999999999, 0.099999999999999978, 0.089999999999999983, 0.079999999999999988, 0.069999999999999979, 0.059999999999999984, 0.049999999999999982, 0.03999999999999998, 0.029999999999999978, 0.01999999999999998, 0.0099999999999999794, 0]
mcm_t = [
[7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7.666666666666667, 7.666666666666667, 7.666666666666667, 7.666666666666667, 8.6666666666666661, 8.6666666666666661, 9.6666666666666661, 10.666666666666666, 11.666666666666666, 12.666666666666666, 13.666666666666666, 14.666666666666666, 15.666666666666666, 17, 18, 19, 20, 21.333333333333332, 22.666666666666668, 25, 27, 30.333333333333332, 33.333333333333336, 37.666666666666664, 43.333333333333336, 51.666666666666664, 65.666666666666671, 89, 141.66666666666666, 351.33333333333331, 351.33333333333331],
[1.6666666666666667, 2.6666666666666665, 3.6666666666666665, 4.666666666666667, 6.333333333333333, 7.333333333333333, 8.6666666666666661, 10.333333333333334, 12.666666666666666, 13.666666666666666, 15.666666666666666, 17.666666666666668, 20, 22, 24, 26, 28.333333333333332, 30.333333333333332, 32.333333333333336, 34.333333333333336, 36.666666666666664, 38.666666666666664, 40.666666666666664, 43, 45, 47, 49.333333333333336, 51.333333333333336, 53.333333333333336, 55.666666666666664, 57.666666666666664, 60.333333333333336, 62.333333333333336, 64.666666666666671, 67.333333333333329, 69.666666666666671, 73, 76, 79.333333333333329, 82.333333333333329, 85.666666666666671, 88.666666666666671, 92, 95, 98.666666666666671, 102.66666666666667, 106, 110, 114.33333333333333, 118.33333333333333, 122.66666666666667, 127.33333333333333, 132.66666666666666, 138.33333333333334, 144, 150, 156, 162, 168, 174.66666666666666, 181, 187.66666666666666, 195, 202.66666666666666, 210.33333333333334, 218.66666666666666, 227, 236.66666666666666, 246.33333333333334, 256.66666666666669, 267.33333333333331, 279, 292, 305.33333333333331, 320.33333333333331, 336.33333333333331, 353.33333333333331, 372, 392.33333333333331, 414.66666666666669, 439.33333333333331, 466.33333333333331, 496.33333333333331, 529.33333333333337, 566.66666666666663, 610, 673.66666666666663, 715, 740.66666666666663, 771, 807.66666666666663, 853.33333333333337, 910.33333333333337, 979.66666666666663, 1074, 1211.6666666666667, 1424, 1801.3333333333333, 2692, 6346.666666666667, 6346.666666666667],
[2.6666666666666665, 5, 7.666666666666667, 10.333333333333334, 12.666666666666666, 15, 17.333333333333332, 20, 22.333333333333332, 25, 28, 31, 34, 37, 40.333333333333336, 43.666666666666664, 46.666666666666664, 50, 53.666666666666664, 57, 61, 64.666666666666671, 68.333333333333329, 72.333333333333329, 76.333333333333329, 80.333333333333329, 84.333333333333329, 89, 93.333333333333329, 98, 102.66666666666667, 107.66666666666667, 112.33333333333333, 117.33333333333333, 122.33333333333333, 127.33333333333333, 133, 139, 145, 151, 157, 163.66666666666666, 170.66666666666666, 178.66666666666666, 186, 193.33333333333334, 201.66666666666666, 210, 218.66666666666666, 227, 236.33333333333334, 246, 255.66666666666666, 266.33333333333331, 277, 288, 300.33333333333331, 312, 324.33333333333331, 337, 350.66666666666669, 364.66666666666669, 379.66666666666669, 395.33333333333331, 412.33333333333331, 430.33333333333331, 449, 468.66666666666669, 490.33333333333331, 513.33333333333337, 537.66666666666663, 563.33333333333337, 590.66666666666663, 621.33333333333337, 654.33333333333337, 689, 727.66666666666663, 768.33333333333337, 813.66666666666663, 869.66666666666663, 924.33333333333337, 984.33333333333337, 1051, 1126, 1211, 1308.6666666666667, 1420.3333333333333, 1551.6666666666667, 1704.6666666666667, 1884.6666666666667, 2105, 2389.6666666666665, 2760.3333333333335, 3203.6666666666665, 3844.3333333333335, 4780, 6215.666666666667, 8744.6666666666661, 14386.666666666666, 36382, 36382],
[8.3333333333333339, 16.333333333333332, 24.333333333333332, 32.666666666666664, 41, 49.666666666666664, 58.666666666666664, 67.666666666666671, 76.666666666666671, 86, 95.666666666666671, 105.66666666666667, 115.66666666666667, 125.66666666666667, 135.66666666666666, 146.66666666666666, 157.33333333333334, 168.33333333333334, 179.33333333333334, 191.33333333333334, 203.33333333333334, 215.66666666666666, 228.66666666666666, 243.66666666666666, 256, 268.33333333333331, 281.33333333333331, 294.33333333333331, 307.66666666666669, 321.66666666666669, 336.66666666666669, 351.33333333333331, 366.33333333333331, 387.33333333333331, 407, 425, 444, 463.33333333333331, 483.33333333333331, 504, 525.66666666666663, 547.66666666666663, 570.66666666666663, 594, 618.33333333333337, 643.66666666666663, 669.66666666666663, 696.66666666666663, 724.66666666666663, 753.66666666666663, 785, 814, 844.66666666666663, 876.66666666666663, 910, 944.66666666666663, 980.66666666666663, 1018.6666666666666, 1058.6666666666667, 1100.6666666666667, 1144.6666666666667, 1190.6666666666667, 1239, 1290, 1344, 1401, 1461.3333333333333, 1525.3333333333333, 1593.3333333333333, 1677.3333333333333, 1762.3333333333333, 1852.3333333333333, 1949.3333333333333, 2056, 2159.6666666666665, 2271.6666666666665, 2392.6666666666665, 2524.6666666666665, 2669, 2828, 3007.6666666666665, 3226.6666666666665, 3470, 3733.3333333333335, 4036.3333333333335, 4383, 4770.333333333333, 5252.333333333333, 5797, 6378, 7110, 7985.666666666667, 9121, 10632.333333333334, 12588.666666666666, 15443, 19867, 27641.333333333332, 45130.333333333336, 115176, 115176],
[18.333333333333332, 37, 59.333333333333336, 80.333333333333329, 101.33333333333333, 123.33333333333333, 145.33333333333334, 168.33333333333334, 191.33333333333334, 215.33333333333334, 239.66666666666666, 264.66666666666669, 290, 316, 342.33333333333331, 369.33333333333331, 397.33333333333331, 425.66666666666669, 452.66666666666669, 480, 508, 537, 566.33333333333337, 597, 628, 660, 695.66666666666663, 729.66666666666663, 764.33333333333337, 800, 837, 875, 914, 954, 995, 1037.6666666666667, 1081.6666666666667, 1127, 1173.6666666666667, 1222, 1272, 1323.6666666666667, 1377, 1432.3333333333333, 1489.3333333333333, 1548.3333333333333, 1610, 1674, 1740.3333333333333, 1809.3333333333333, 1881, 1956.6666666666667, 2034.6666666666667, 2116, 2201, 2289.3333333333335, 2382, 2479, 2581, 2687, 2799.3333333333335, 2917, 3041, 3172, 3324, 3482.6666666666665, 3650.6666666666665, 3830.3333333333335, 4016.3333333333335, 4218.333333333333, 4434.333333333333, 4671.666666666667, 4919.333333333333, 5185, 5465, 5756, 6067.666666666667, 6406, 6775, 7185.333333333333, 7632, 8129, 8682, 9300.6666666666661, 10001.333333333334, 10798.333333333334, 11713.333333333334, 12776.333333333334, 14020, 15500, 17289.333333333332, 19500, 22297, 26100, 31072.333333333332, 38282, 49462.666666666664, 69378, 114616.33333333333, 297331, 297331],
[38.666666666666664, 82, 125, 169, 214, 260, 307, 362.33333333333331, 407.33333333333331, 453.33333333333331, 500.33333333333331, 548.66666666666663, 600, 654.66666666666663, 710.66666666666663, 767.66666666666663, 825.66666666666663, 885.66666666666663, 945.33333333333337, 1003.3333333333334, 1062.3333333333333, 1123.3333333333333, 1185.3333333333333, 1249.3333333333333, 1314.6666666666667, 1382, 1451.6666666666667, 1523, 1596, 1671, 1748.3333333333333, 1828, 1910, 1994, 2080.6666666666665, 2170.6666666666665, 2262.6666666666665, 2358.3333333333335, 2456.6666666666665, 2562.6666666666665, 2670.6666666666665, 2779.3333333333335, 2905.6666666666665, 3032.3333333333335, 3163.3333333333335, 3304.3333333333335, 3445.3333333333335, 3592.6666666666665, 3749.3333333333335, 3907, 4093.3333333333335, 4263.666666666667, 4447.333333333333, 4650.333333333333, 4858.333333333333, 5065.666666666667, 5279.333333333333, 5502.333333333333, 5727.666666666667, 5952.666666666667, 6195, 6443.333333333333, 6704.333333333333, 7001.666666666667, 7316, 7627.666666666667, 7974.666666666667, 8335.3333333333339, 8702.6666666666661, 9094.3333333333339, 9542.3333333333339, 10019.666666666666, 10520.333333333334, 11081.333333333334, 11682.333333333334, 12290.666666666666, 13001.333333333334, 13773, 14600.666666666666, 15529.666666666666, 16508.333333333332, 17571, 18779.333333333332, 20155.333333333332, 21706.666666666668, 23436.666666666668, 25460.666666666668, 27721, 30450.666666666668, 33721.333333333336, 37632.666666666664, 42508.666666666664, 49138.333333333336, 57192, 68085, 83782.666666666672, 108028, 152979.66666666666, 251274.66666666666, 646436, 646437],
[100, 212, 325.33333333333331, 431, 548.66666666666663, 670.66666666666663, 786, 910.33333333333337, 1039.3333333333333, 1167.3333333333333, 1297.6666666666667, 1446.3333333333333, 1597.3333333333333, 1760.3333333333333, 1914, 2065.3333333333335, 2218.6666666666665, 2373.3333333333335, 2547.6666666666665, 2731.3333333333335, 2915.6666666666665, 3102, 3321.6666666666665, 3506, 3695.6666666666665, 3910.3333333333335, 4127, 4344, 4553, 4768.666666666667, 5013, 5256.666666666667, 5510, 5753, 6000.333333333333, 6276.666666666667, 6558.333333333333, 6850.333333333333, 7145, 7439, 7764.666666666667, 8136.333333333333, 8516.6666666666661, 8916.3333333333339, 9323, 9723.3333333333339, 10103.666666666666, 10475.666666666666, 10881.333333333334, 11288, 11723.666666666666, 12195.666666666666, 12657.333333333334, 13137.333333333334, 13651, 14196.666666666666, 14771.666666666666, 15346.333333333334, 15967.666666666666, 16608.333333333332, 17336.666666666668, 18046.333333333332, 18792.333333333332, 19661.333333333332, 20563.666666666668, 21481, 22377.333333333332, 23330.666666666668, 24298, 25383.333333333332, 26581.666666666668, 27827, 29280, 30702.666666666668, 32236, 34052.333333333336, 35826.333333333336, 37834.333333333336, 39975.333333333336, 42311.666666666664, 45034.333333333336, 48020, 51235.666666666664, 54658.666666666664, 58733, 63226.333333333336, 68515, 74720.666666666672, 81923, 89823, 99866.333333333328, 112258.66666666667, 128476, 151249, 177101.33333333334, 217014.33333333334, 279953.66666666669, 378556.33333333331, 575243.66666666663, 1568044, 1568044.6666666667],
[160, 328, 499.33333333333331, 680, 858.66666666666663, 1041, 1227, 1418, 1612.3333333333333, 1811, 2014, 2224.3333333333335, 2461.3333333333335, 2685.6666666666665, 2915.3333333333335, 3156, 3397, 3643.6666666666665, 3899, 4158, 4423.333333333333, 4695.666666666667, 4973.333333333333, 5281, 5651.666666666667, 5956.666666666667, 6256.666666666667, 6566, 6883, 7209, 7547, 7892, 8247.3333333333339, 8614.3333333333339, 8991.6666666666661, 9403.3333333333339, 9804.3333333333339, 10218, 10646, 11087, 11543.666666666666, 12015, 12505.333333333334, 13010.333333333334, 13534, 14097, 14675.333333333334, 15259.666666666666, 15867.333333333334, 16498.666666666668, 17156, 17839.666666666668, 18551.666666666668, 19295.333333333332, 20071, 20881.333333333332, 21730, 22618.333333333332, 23548.666666666668, 24524, 25551, 26630.666666666668, 27768.333333333332, 28975.666666666668, 30244.333333333332, 31585.333333333332, 33005.666666666664, 34515, 36117, 37825.333333333336, 39649.666666666664, 41602.333333333336, 43696, 45949.666666666664, 48377.666666666664, 51004.333333333336, 53854.666666666664, 56957, 60350, 64099.333333333336, 68200.333333333328, 72747.333333333328, 77810, 83489.666666666672, 89913, 97209.333333333328, 105587.33333333333, 115326.33333333333, 126726, 140298.33333333334, 156711.66666666666, 176974.33333333334, 202632.33333333334, 236132, 281782, 347458.66666666669, 450191.66666666669, 626633, 1012991.6666666666, 2635258.6666666665, 2635259.6666666665],
[190, 383.33333333333331, 580.33333333333337, 782.33333333333337, 988, 1199, 1413.6666666666667, 1634.3333333333333, 1902.6666666666667, 2143.3333333333335, 2376.6666666666665, 2615.3333333333335, 2859.3333333333335, 3108.3333333333335, 3364.3333333333335, 3626, 3894.3333333333335, 4168.333333333333, 4451.666666666667, 4740, 5035.666666666667, 5338.666666666667, 5651.333333333333, 5969.666666666667, 6298, 6633.666666666667, 6981, 7336, 7701.333333333333, 8076.333333333333, 8463, 8859.6666666666661, 9268.6666666666661, 9690, 10123.666666666666, 10573.333333333334, 11034.333333333334, 11511, 12002.333333333334, 12509, 13039, 13580.666666666666, 14142.666666666666, 14724.333333333334, 15329, 15952.666666666666, 16599.666666666668, 17274.333333333332, 17973, 18699, 19453.666666666668, 20242.666666666668, 21062.666666666668, 21933.666666666668, 22839, 23771.666666666668, 24749.666666666668, 25771.666666666668, 26842.333333333332, 27967.666666666668, 29148, 30389.666666666668, 31697, 33077, 34532.666666666664, 36075, 37707.666666666664, 39438.333333333336, 41318, 43282.333333333336, 45378, 47619.333333333336, 50025, 52615.333333333336, 55402, 58414.666666666664, 61700, 65261.333333333336, 69159, 73476.666666666672, 78222.333333333328, 83450.666666666672, 89273, 95810.666666666672, 103183.66666666667, 111566.33333333333, 121180.66666666667, 132343.66666666666, 145474.33333333334, 161182.66666666666, 180046, 203318.66666666666, 232829, 271350.66666666669, 323908.33333333331, 399486.66666666669, 517532.66666666669, 727268.33333333337, 1199465.6666666667, 3088186.3333333335, 3088187.6666666665],
[302.66666666666669, 606.33333333333337, 916, 1234, 1581.3333333333333, 1910.6666666666667, 2249.6666666666665, 2622.3333333333335, 2973.3333333333335, 3332.3333333333335, 3701.3333333333335, 4076.6666666666665, 4462, 4854.333333333333, 5259.666666666667, 5671.666666666667, 6092.666666666667, 6523.333333333333, 6968, 7420, 7884.333333333333, 8359.6666666666661, 8850.3333333333339, 9350.6666666666661, 9864.3333333333339, 10393.666666666666, 10936.666666666666, 11495, 12068.333333333334, 12657, 13265.333333333334, 13890.666666666666, 14533.333333333334, 15195.333333333334, 15876.333333333334, 16591.666666666668, 17315, 18086, 18849.333333333332, 19636.333333333332, 20463, 21302.666666666668, 22173.333333333332, 23071.333333333332, 24004.666666666668, 24971, 25974.666666666668, 27015.666666666668, 28100.666666666668, 29230.666666666668, 30400.666666666668, 31636.666666666668, 32940.666666666664, 34284.333333333336, 35687, 37153.333333333336, 38685.333333333336, 40289, 41973, 43739.333333333336, 45592.333333333336, 47554, 49607.333333333336, 51773.333333333336, 54114.666666666664, 56535.666666666664, 59100.333333333336, 61822, 64721.333333333336, 67806.666666666672, 71097.666666666672, 74624.666666666672, 78406, 82473, 86877.666666666672, 91663.666666666672, 96812.666666666672, 102417, 108561.66666666667, 115287.66666666667, 122698, 130909.66666666667, 140068, 150331.66666666666, 161758.33333333334, 174952, 190219.33333333334, 207518.33333333334, 228129.33333333334, 252513, 282185.66666666669, 318475.66666666669, 364887.33333333331, 425706, 508128, 627068.33333333337, 810794.66666666663, 1140471, 1875951.3333333333, 4827712.666666667, 4827714]]
qm_t = [
[0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
[0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.66666666666666663, 0.66666666666666663, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 1.6666666666666667, 2.3333333333333335, 2.3333333333333335],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.66666666666666663, 1, 1, 1.3333333333333333, 2.3333333333333335, 3.3333333333333335, 6.666666666666667, 10, 16.333333333333332, 16.333333333333332],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.3333333333333333, 2.3333333333333335, 3.3333333333333335, 4.333333333333333, 5.333333333333333, 6.333333333333333, 7.333333333333333, 8.3333333333333339, 9.3333333333333339, 10.333333333333334, 11.333333333333334, 12.333333333333334, 13.333333333333334, 14.333333333333334, 15.333333333333334, 16.333333333333332, 17.333333333333332, 18.333333333333332, 19.333333333333332, 20.333333333333332, 21.333333333333332, 22.333333333333332, 23.333333333333332, 24.333333333333332, 25.333333333333332, 26.333333333333332, 27.333333333333332, 28.333333333333332, 29.333333333333332, 30.333333333333332, 31.333333333333332, 32.333333333333336, 33.333333333333336, 34.333333333333336, 35.333333333333336, 37.333333333333336, 38.333333333333336, 39.333333333333336, 40.333333333333336, 41.333333333333336, 42.333333333333336, 43.333333333333336, 44.333333333333336, 45.333333333333336, 46.333333333333336, 47.333333333333336, 48.333333333333336, 49.666666666666664, 51, 52, 57, 61.666666666666664, 65.666666666666671, 70.666666666666671, 74.666666666666671, 78.666666666666671, 83, 87, 91, 101, 111, 121, 141.33333333333334, 161.66666666666666, 198.66666666666666, 353, 353],
[0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 0.33333333333333331, 6.666666666666667, 9.6666666666666661, 12.666666666666666, 15.666666666666666, 18.666666666666668, 21.666666666666668, 24.666666666666668, 27.666666666666668, 30.666666666666668, 34, 37, 40, 43, 46, 49, 52, 55, 58, 61, 64, 67, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 149, 153, 157, 160, 164, 168, 172, 175.66666666666666, 178.66666666666666, 181.66666666666666, 184.66666666666666, 187.66666666666666, 190.66666666666666, 193.66666666666666, 196.66666666666666, 200, 214.33333333333334, 227.66666666666666, 240.66666666666666, 253.66666666666666, 266.66666666666669, 280, 293.33333333333331, 306.33333333333331, 319.33333333333331, 332.33333333333331, 345.66666666666669, 380, 414.33333333333331, 448.66666666666669, 482.66666666666669, 568, 653.33333333333337, 832.33333333333337, 1192.6666666666667, 2843.3333333333335, 2843.6666666666665],
[1.3333333333333333, 16.666666666666668, 31.666666666666668, 46.666666666666664, 61.666666666666664, 76.666666666666671, 91.666666666666671, 105.66666666666667, 119.66666666666667, 133.66666666666666, 147.66666666666666, 163, 178, 193, 208, 223, 238, 253, 267, 281, 295, 309, 323, 337, 351, 370.33333333333331, 384.33333333333331, 398.33333333333331, 412.33333333333331, 426.33333333333331, 440.33333333333331, 454.33333333333331, 468.33333333333331, 482.33333333333331, 496.33333333333331, 510.33333333333331, 524.33333333333337, 538.33333333333337, 552.33333333333337, 566.33333333333337, 580.33333333333337, 594.33333333333337, 609.33333333333337, 624.33333333333337, 639.33333333333337, 654.33333333333337, 669.33333333333337, 684.33333333333337, 699.33333333333337, 714.33333333333337, 730, 747.33333333333337, 763.33333333333337, 779.33333333333337, 794.33333333333337, 809.33333333333337, 826.33333333333337, 841.33333333333337, 855.33333333333337, 869.33333333333337, 883.33333333333337, 897.33333333333337, 911.33333333333337, 926.33333333333337, 941.33333333333337, 955.33333333333337, 970.33333333333337, 984.33333333333337, 999.33333333333337, 1013.3333333333334, 1028.3333333333333, 1042.3333333333333, 1057.3333333333333, 1072.3333333333333, 1087.3333333333333, 1164.3333333333333, 1247.6666666666667, 1332, 1413.3333333333333, 1498.3333333333333, 1583.3333333333333, 1669.6666666666667, 1754.6666666666667, 1844, 1922, 2000, 2085, 2170, 2255.3333333333335, 2520.6666666666665, 2813, 3077, 3401, 3688, 4459, 5280, 7324, 9540.6666666666661, 18399, 71654.666666666672, 71656.333333333328],
[37.666666666666664, 75, 109, 152, 189, 240.33333333333334, 278.33333333333331, 316.33333333333331, 360.66666666666669, 408.66666666666669, 465.66666666666669, 515.66666666666663, 560.33333333333337, 604.66666666666663, 643.66666666666663, 682.66666666666663, 727, 777.66666666666663, 826.33333333333337, 877, 919.66666666666663, 962.33333333333337, 1001, 1040.6666666666667, 1083.3333333333333, 1126.3333333333333, 1168.3333333333333, 1210, 1248.6666666666667, 1291.3333333333333, 1333.3333333333333, 1376, 1418, 1456.3333333333333, 1494.3333333333333, 1540.3333333333333, 1594.6666666666667, 1650, 1698, 1746.6666666666667, 1805.6666666666667, 1861, 1917.3333333333333, 1979.6666666666667, 2040.6666666666667, 2092.6666666666665, 2156.6666666666665, 2216.6666666666665, 2276, 2337, 2398.3333333333335, 2463.6666666666665, 2517.3333333333335, 2598, 2650.3333333333335, 2728, 2777.6666666666665, 2820.6666666666665, 2859, 2918, 2962.3333333333335, 3006.6666666666665, 3049, 3091, 3133.3333333333335, 3168.6666666666665, 3204, 3244.3333333333335, 3283.6666666666665, 3319.3333333333335, 3357.6666666666665, 3620, 3905.6666666666665, 4176.666666666667, 4437, 4702.666666666667, 4968, 5319.666666666667, 5598, 5872, 6132.333333333333, 6411.333333333333, 6679.333333333333, 6941, 7222.333333333333, 7606, 7959.333333333333, 8237.6666666666661, 9334.6666666666661, 10362, 11383.333333333334, 12405.666666666666, 13610.333333333334, 18007.333333333332, 21680.333333333332, 25302, 37513.666666666664, 68004.666666666672, 126004.66666666667, 534378.33333333337, 534381],
[131.33333333333334, 262.33333333333331, 393.33333333333331, 524.33333333333337, 654.33333333333337, 785.33333333333337, 916.33333333333337, 1047.3333333333333, 1177.3333333333333, 1309.3333333333333, 1441.3333333333333, 1594.6666666666667, 1737.6666666666667, 1877.3333333333333, 2017, 2156.6666666666665, 2296, 2435.3333333333335, 2574.6666666666665, 2714, 2853, 2997.6666666666665, 3147.6666666666665, 3317.3333333333335, 3465, 3603, 3739, 3875, 4011, 4147, 4283, 4419, 4555, 4691, 4827, 4965.666666666667, 5101.666666666667, 5237.666666666667, 5373.666666666667, 5509.666666666667, 5645.666666666667, 5781.666666666667, 5917.666666666667, 6053.666666666667, 6190.333333333333, 6326.333333333333, 6461.666666666667, 6596.666666666667, 6731.666666666667, 6866.666666666667, 7001.666666666667, 7139, 7274, 7409, 7546.333333333333, 7681.333333333333, 7816.333333333333, 7951.333333333333, 8091.333333333333, 8226.3333333333339, 8361.3333333333339, 8496.3333333333339, 8631.3333333333339, 8766.6666666666661, 8902, 9037.3333333333339, 9172.3333333333339, 10446, 11769.333333333334, 13047, 14337.333333333334, 15615.666666666666, 16893.666666666668, 18171.666666666668, 19449.666666666668, 20727.666666666668, 22005.333333333332, 23285, 24563.666666666668, 25843.666666666668, 27121.666666666668, 28400, 29679, 30958, 32240.666666666668, 33519.666666666664, 40349.333333333336, 47216.666666666664, 54083.666666666664, 60950.333333333336, 67847.333333333328, 74679.333333333328, 105965.66666666667, 136962.66666666666, 167950.33333333334, 269649.66666666669, 371476.33333333331, 657761, 2298330.3333333335, 15212044.333333334, 15212051.333333334],
[344, 685, 1026.6666666666667, 1367.6666666666667, 1708.6666666666667, 2049.6666666666665, 2423, 2870.3333333333335, 3281, 3665, 4016, 4382, 4733, 5084, 5450.333333333333, 5798.333333333333, 6146.333333333333, 6494.333333333333, 6842.333333333333, 7190.333333333333, 7538.333333333333, 7886.333333333333, 8234.3333333333339, 8582.3333333333339, 8930.3333333333339, 9278.3333333333339, 9626.3333333333339, 9974.3333333333339, 10322.333333333334, 10670.333333333334, 11018.333333333334, 11368.333333333334, 11716.333333333334, 12065, 12416.666666666666, 12764.666666666666, 13112.666666666666, 13460.666666666666, 13809.333333333334, 14157.333333333334, 14505.333333333334, 14854, 15202, 15550, 15898, 16246.666666666666, 16594.666666666668, 16942.666666666668, 17290.666666666668, 17639.333333333332, 17987.333333333332, 18335.333333333332, 18683.333333333332, 19031.333333333332, 19379.333333333332, 19727.333333333332, 20075.333333333332, 20423.333333333332, 20771.333333333332, 21119.333333333332, 21467.333333333332, 21817.333333333332, 22165.333333333332, 26587, 31004.666666666668, 35420.333333333336, 39887.666666666664, 44341, 48840, 53296, 57750.333333333336, 62231.666666666664, 66685, 71145, 75605.333333333328, 80063.666666666672, 84522.666666666672, 88981, 93502.666666666672, 98037, 102571.66666666667, 107110, 111688.33333333333, 116223.66666666667, 144159.66666666666, 173066.66666666666, 202258.33333333334, 231431, 260508.33333333334, 289720, 318900.33333333331, 483075, 646081.66666666663, 809090.66666666663, 1417163, 2024066.6666666667, 3963576, 9237013.333333334, 22740188.666666668, 285099700.66666669, 285099713.33333331],
[1247.3333333333333, 2494, 3748.3333333333335, 5002, 6259.666666666667, 7506.666666666667, 8799.6666666666661, 10082.333333333334, 11330.666666666666, 12577.666666666666, 13824.333333333334, 15071, 16336.333333333334, 17583, 18829, 20075.666666666668, 21375.333333333332, 22622, 23883, 25129.666666666668, 26378, 27624.666666666668, 28871.333333333332, 30118, 31366, 32612.666666666668, 33860.666666666664, 35107.333333333336, 36355.333333333336, 37602.333333333336, 38848.333333333336, 40095, 41343, 42591, 43837.666666666664, 45125, 46435, 47800.333333333336, 49052, 50304.666666666664, 51559, 52811.666666666664, 54064.333333333336, 55317, 56569.666666666664, 57821.333333333336, 59073.666666666664, 60327.666666666664, 61581.666666666664, 62833.333333333336, 64131, 65377.666666666664, 66624.333333333328, 67872.333333333328, 69119, 70365.666666666672, 71613.666666666672, 72860.333333333328, 74106.333333333328, 94547, 116510, 138409.33333333334, 159169.66666666666, 180709.66666666666, 200283.66666666666, 219799.66666666666, 239285, 258745.66666666666, 278218.33333333331, 297742, 317201.33333333331, 336927.66666666669, 356462, 375962, 395419.33333333331, 414906, 434395.66666666669, 453867, 473618, 493093.33333333331, 512587, 532137.66666666663, 705200.33333333337, 878308.66666666663, 1051107.6666666667, 1224168.6666666667, 1398870.3333333333, 1572313.3333333333, 1745317.3333333333, 1918381.6666666667, 2949910.6666666665, 3979782, 5010521.333333333, 6041607, 10724587, 15399873.666666666, 32649134, 87967659.666666672, 495002816, 4997440012.333333, 4997440037.666667]]

diff = [[0] * len(qm_t[0]) for i in range(len(qm_t))]
for i in range(len(qm_t)):
    for j in range(len(qm_t[0])):
        diff[i][j] = mcm_t[i][j] - qm_t[i][j]

max_time = 5e4

plt.pcolormesh(eps, kv, mcm_t, vmin=0, vmax=max_time)
plt.colorbar(label="t, мкс")
plt.title("Зависимость времени расчета методом Монте-Карло от\nжелаемой точности eps и размерности задачи n")
plt.xlabel("eps")
plt.ylabel("n")
plt.tight_layout()
plt.show()

plt.pcolormesh(eps, kv, qm_t, vmin=0, vmax=max_time)
plt.colorbar(label="t, мкс")
plt.title("Зависимость времени расчета методом трапеций от\nжелаемой точности eps и размерности задачи n")
plt.xlabel("eps")
plt.ylabel("n")
plt.tight_layout()
plt.show()

plt.pcolormesh(eps, kv, diff, cmap = 'bwr', vmin=-max_time, vmax=max_time)
plt.colorbar(label="t, мкс")
plt.title("Зависимость разницы между временем расчета\n методом Монте-Карло и методом трапеций от желаемой\n точности eps и размерности задачи n")
plt.xlabel("eps")
plt.ylabel("n")
plt.tight_layout()
plt.show()